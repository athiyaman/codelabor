<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=MS949">
<title>RexpreViewTest</title>
<script language="javascript" src="../../rexscript/rexpert.js"></script>
<script language="javascript" src="../../rexscript/rexpert_properties.js"></script>

<script language="vbscript">
	Sub fnOpenRexViewerMulti()
		Dim oRptMultiParam
		Set oRptMultiParam = rex_GetgoDictionay()

		Call oRptMultiParam.put("rex_rptname", "dummy")

		Call oRptMultiParam.put("sub1", fnGetParam1())
		Call oRptMultiParam.put("sub2", fnGetParam1())
		
		Call rex_gfRexRptOpenMulti("iframe", "", ifrmRexPreview, oRptMultiParam)
	End Sub

	Function fnGetParam1()
		Dim oRptMainParam
		Set oRptMainParam = rex_GetgoDictionay()

		Call oRptMainParam.put("rex_rptname", "samples/multiparam/multiparam1")

		Call oRptMainParam.put("rex_datatype", "XML")

		Call oRptMainParam.put("rex_userservice", "Sql2")


		' 옵션 - rex_gfRexRptOpenMulti 함수 호출시 적용됨 AddReportSection
		' Call oRptMainParam.put("rex_addreportsection", "followmainreport=1;usemainreportdata=0;pagereset=0")
		Call oRptMainParam.put("rex_addreportsection", "followmainreport=1;usemainreportdata=0;pagereset=0")

		' 옵션 - 파라메터 설정
		' Call oRptMainParam.put("custid", txtData.value)
		' Call oRptMainParam.put("id", "0")

		fnGetParam1 = oRptMainParam
	End Function

</script>

</head>
<body>
	<button id="btnRexViewer" onclick="fnOpenRexViewerMulti();">레포트 보기</button><br>

	<textarea id="txtData" rows="5" cols="100"></textarea>
	<br>
	<iframe id="ifrmRexPreview" src="../../RexPreView.aspx" width="100%" height="450"></iframe>
</body>
</html>
